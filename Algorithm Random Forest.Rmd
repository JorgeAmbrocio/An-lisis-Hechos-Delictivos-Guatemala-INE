---
title: "R Notebook"
output: html_notebook
---

# Random Forest
Análisis de los conjuntos de datos sindicados y agraviados, recopilados por el MP y publicados mediante el Instituto de Estadística Nacional de Guatemala. 

Para la ejecución de esta sección del análisis se desarrolla el algoritmo bosque aleatorio.

## Carga de librerías 
```{r}
library(rpart) # para construcción del árbol
library(rpart.plot) # para graficar el árbol
library(dplyr) # para manipular los conjuntos de datos
library(readxl) # para leer los archivos excel
```


## Carga de los datos
```{r}

dAgraviados_2020 <- read_xlsx("Data\\Agraviados 2020.xlsx",sheet = "Sheet1")
dAgraviados_2022 <- read_xlsx("Data\\Agraviados 2022.xlsx", sheet = "Sheet1")

dAgraviados_2023 <- read_xlsx("Data\\Agraviados 2023.xlsx", sheet = "Sheet1")
dSindicados_2023 <- read_xlsx("Data\\Sindicados 2023.xlsx", sheet = "Sheet1")


```


## Obtención de diccionarios
```{r}
dicAgraviados22 <- read_xlsx("Data\\Diccionario 2022.xlsx", sheet="Dic")
dicAgraviados23 <- read_xlsx("Data\\Diccionario Agraviados 2023.xlsx", sheet="Dic")
dicSindicados23 <- read_xlsx("Data\\Diccionario Sindicados 2023.xlsx", sheet="Dic")

```

## Preparación de los conjuntos de datos

### Agraviados 2023
```{r}
# Asignar el conjunto de datos
sdAgraviados23 <- dAgraviados_2023

# Manipulación del conjunto para delimitar 
sdAgraviados23 <- sdAgraviados23 %>%
  left_join(dicAgraviados22, by = c("delito_com"="Etiqueta")) %>%
  select(-delito_com, -Valor) %>%
  rename(delito_com = Código) %>%
  left_join(dicAgraviados23[dicAgraviados23$Valor == "DEPARTAMENTO DE OCURRENCIA DEL HECHO",], by = c("depto_ocu_hecho" ="Etiqueta")) %>%
  select(-depto_ocu_hecho, -Valor) %>%
  rename(depto_ocu_hecho = Código)

sdAgraviados23 <- sdAgraviados23 %>%
  left_join(dicAgraviados23, by = c("sexo_agraviados" ="Etiqueta")) %>%
  select(-sexo_agraviados, -Valor) %>%
  rename(sexo_agraviados = Código)


sdAgraviados23 <- sdAgraviados23 %>%
  left_join(dicAgraviados23, by = c("est_conyugal" ="Etiqueta")) %>%
  select(-est_conyugal, -Valor) %>%
  rename(est_conyugal = Código)
            
```

### Sindicados 2023
```{r}
colnames(dSindicados_2023)

# Asignar el conjunto de datos
sdSindicados23 <- dSindicados_2023

# Manipulación del conjunto
sdSindicados23 <- sdSindicados23 %>%
  left_join(dicSindicados23, by=c("delito_com"="Etiqueta")) %>%
  select(-delito_com, - Valor) %>%
  rename(delito_com = Código)

sdSindicados23 <- sdSindicados23 %>%
  left_join(dicSindicados23, by=c("sexo_per"="Etiqueta")) %>%
  select(-sexo_per, - Valor) %>%
  rename(sexo_per = Código)


sdSindicados23 <- sdSindicados23 %>%
  left_join(dicSindicados23, by=c("est_conyugal"="Etiqueta")) %>%
  select(-est_conyugal, - Valor) %>%
  rename(est_conyugal = Código)


sdSindicados23 <- sdSindicados23 %>%
  left_join(dicSindicados23, by=c("depto_ocu_hecho"="Etiqueta")) %>%
  select(-depto_ocu_hecho, - Valor) %>%
  rename(depto_ocu_hecho = Código)


```